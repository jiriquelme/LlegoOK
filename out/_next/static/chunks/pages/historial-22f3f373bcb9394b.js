(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[567],{5536:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/historial",function(){return a(234)}])},234:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var n=a(4848),o=a(6540),r=a(4335),i=a(7277),s=a.n(i),l=a(6715);function d(){let[e,t]=(0,o.useState)([]),[a,i]=(0,o.useState)(null),d=(0,l.useRouter)();(0,o.useEffect)(()=>{(async()=>{try{let e=(await r.A.get("http://34.29.123.189/encomiendas/")).data;console.log("Datos del backend (encomiendas):",e);let a=await Promise.all(e.map(async e=>{var t,a;let n="Sin informaci\xf3n",o="Sin informaci\xf3n";try{if(e.Departamento){console.log("Consultando departamento con ID: ".concat(e.Departamento));let a=await r.A.get("http://34.29.123.189/departamentos/".concat(e.Departamento));n=(null===(t=a.data)||void 0===t?void 0:t.nombre)||"Sin informaci\xf3n",console.log("Datos del departamento:",a.data)}}catch(e){console.error("Error al obtener el nombre del departamento:",e.message)}try{if(e.Residente){console.log("Consultando residente con ID: ".concat(e.Residente));let t=await r.A.get("http://34.29.123.189/residentes/".concat(e.Residente));o=(null===(a=t.data)||void 0===a?void 0:a.nombre)||"Sin informaci\xf3n",console.log("Datos del residente:",t.data)}}catch(e){console.error("Error al obtener el nombre del residente:",e.message)}return{id:e.id,fechaLlegada:e.Fecha_Llegada||null,fechaRecepcion:e.Fecha_Recepcion||null,departamento:n,residente:o,estado:e.Fecha_Recepcion?"Entregado":"Pendiente"}}));console.log("Datos formateados con nombres:",a),t(a)}catch(e){console.error("Error al obtener los datos de encomiendas:",e.message),i("No se pudieron cargar las encomiendas.")}})()},[]);let c=e=>{if(!e)return"Fecha no disponible";let t=new Date(e);return isNaN(t.getTime())?"Fecha inv\xe1lida":t.toLocaleString("es-CL",{timeZone:"America/Santiago"})};return(0,n.jsxs)("div",{className:s().container,children:[(0,n.jsx)("h1",{className:s().title,children:"Historial de Encomiendas"}),(0,n.jsx)("button",{className:s().backButton,onClick:()=>d.push("/"),children:"← Volver"}),a?(0,n.jsx)("p",{className:s().error,children:a}):(0,n.jsx)("div",{className:s().tableContainer,children:(0,n.jsxs)("table",{className:s().table,children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Fecha de Llegada"}),(0,n.jsx)("th",{children:"Departamento"}),(0,n.jsx)("th",{children:"Residente"}),(0,n.jsx)("th",{children:"Estado"})]})}),(0,n.jsx)("tbody",{children:e.map(e=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:c(e.fechaLlegada)}),(0,n.jsx)("td",{children:e.departamento}),(0,n.jsx)("td",{children:e.residente}),(0,n.jsx)("td",{className:"Pendiente"===e.estado?s().pendiente:s().entregado,children:e.estado})]},e.id))})]})})]})}},7277:e=>{e.exports={container:"Historial_container__FiCH2",title:"Historial_title__NsGWf",backButton:"Historial_backButton__e9_28",error:"Historial_error__I4uKj",tableContainer:"Historial_tableContainer__S0p0r",table:"Historial_table__1kpnV",pendiente:"Historial_pendiente__qIpIe",entregado:"Historial_entregado__rZ6tC"}}},e=>{var t=t=>e(e.s=t);e.O(0,[909,636,593,792],()=>t(5536)),_N_E=e.O()}]);